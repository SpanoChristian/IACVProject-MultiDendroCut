function [gScore, dataFidelity, modelComplexity] = getGricScore(rSqr, ...
    sigma, k, n, weight)
%GETGRICSCORE the higher the worse
% k : target number of clusters
% n : number of clusters found so far

% n = numel(rSqr);
% stdN = clustStats.stdN;
% confInt = clustStats.CI;
% meanN = round(mean(confInt));

% Sum for number of rSqr element
%dataFidelity = sum(min(rSqr./sigma^2, 2));

if n == 0
    
end
dataFidelity = min(mean(rSqr./sigma, 'omitnan'), abs(k - n));
%modelComplexity = 1/(exp(-(((n-lambda1)/(lambda2)))^(2)));
%modelComplexity = 10/(exp(-(((n-lambda1)/(lambda2)))^(2))+(1/10));
%modelComplexity = (n - lambda)^2;
modelComplexity = weight*abs(k - n);

% Rationale: hav
gScore = dataFidelity + weight*abs(k - n);


disp([["C found    : " n]; ...
      ["Min Res    : " mean(rSqr)]; ...
      ["Complexity : " modelComplexity]; ...
      ["Fidelity   : " dataFidelity]; ...
      ["gScore     : " gScore]])
disp(["C/Gscore : " modelComplexity + " vs. " + dataFidelity]);

end

